{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<link rel="stylesheet" href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css">
{% endblock %}

{% block content %}
<div class="data-page">
    <!-- Intro Section -->
    <div class="data-intro">
        <div class="data-intro-content">
            <h1>Data Collections</h1>
            <p>Curated datasets from various domains, regularly updated and freely available. Each collection includes
                comprehensive metadata, download options, and platform integrations.</p>
        </div>
        <div class="data-intro-image">
            <img src="/static/la-corniche-near-monaco.jpg" alt="La Corniche near Monaco. Claude Monet, 1884" />
        </div>
    </div>

    <!-- FOMC Statements Section -->
    <div class="data-section">
        <div class="data-section-header">
            <h2 class="data-section-title">FOMC Meeting Statements & Minutes</h2>
        </div>
        <div class="data-section-badge">
            <img src="https://github.com/vtasca/fed-statement-scraping/actions/workflows/main.yml/badge.svg" alt="GitHub Actions" />
        </div>

        <div class="data-section-meta">
            <div class="meta-item">
                <span class="meta-label">Size</span>
                <span class="meta-value" id="fomc-data-size">Loading...</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Type</span>
                <span class="meta-value">CSV</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Rows</span>
                <span class="meta-value" id="fomc-rows">Loading...</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Updates</span>
                <span class="meta-value">Weekly</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">History</span>
                <span class="meta-value">Since 2000</span>
            </div>
        </div>

        <div class="data-section-description">
            Automatically scraped Federal Reserve FOMC meeting statements and minutes since 2000. Tracks US monetary
            policy changes through time with comprehensive metadata including meeting dates, statement types, and full
            text content. Updated weekly to capture the latest policy decisions and economic outlook.
        </div>

        <div class="platform-links">
            <a href="https://github.com/vtasca/fed-statement-scraping" class="platform-link" target="_blank"
                rel="noopener noreferrer">
                <i class="fab fa-github"></i>
                GitHub
            </a>
            <a href="https://www.kaggle.com/datasets/vladtasca/fomc-meeting-statements-and-minutes" class="platform-link" target="_blank" rel="noopener noreferrer">
                <i class="fab fa-kaggle"></i>
                Kaggle
            </a>
            <a href="https://huggingface.co/datasets/vtasca/fomc-statements-minutes" class="platform-link" target="_blank" rel="noopener noreferrer">
                <img src="/static/hf-logo-bw.svg" alt="Hugging Face">
                Hugging Face
            </a>
        </div>

        <div class="code-snippet-container">
            <pre><code class="language-bash"># Download the dataset
curl -o fomc_statements.csv https://raw.githubusercontent.com/vtasca/fed-statement-scraping/main/data/fomc_statements.csv</code></pre>
        </div>

    </div>

    <!-- Wikipedia Pageviews Section -->
    <div class="data-section">
        <div class="data-section-header">
            <h2 class="data-section-title">Wikipedia Article Pageviews</h2>
        </div>
        <div class="data-section-badge">
            <img src="https://github.com/vtasca/wikipedia-pageviews/actions/workflows/main.yml/badge.svg" alt="GitHub Actions" />
        </div>

        <div class="data-section-meta">
            <div class="meta-item">
                <span class="meta-label">Size</span>
                <span class="meta-value" id="wikipedia-data-size">Loading...</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Type</span>
                <span class="meta-value">CSV</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Rows</span>
                <span class="meta-value" id="wikipedia-rows">Loading...</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Updates</span>
                <span class="meta-value">Daily</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">History</span>
                <span class="meta-value">Since 2016</span>
            </div>
        </div>

        <div class="data-section-description">
            Daily aggregation of the 100 most popular Wikipedia articles by pageviews since 2016. Enables tracking
            trending topics and public interest patterns over time. Includes article titles, pageview counts, dates, and
            language information for comprehensive analysis of web traffic patterns.
        </div>

        <div class="platform-links">
            <a href="https://github.com/vtasca/wikipedia-pageviews" class="platform-link" target="_blank"
                rel="noopener noreferrer">
                <i class="fab fa-github"></i>
                GitHub
            </a>
            <a href="https://www.kaggle.com/datasets/vladtasca/wikipedia-pageviews" class="platform-link" target="_blank" rel="noopener noreferrer">
                <i class="fab fa-kaggle"></i>
                Kaggle
            </a>
            <a href="https://huggingface.co/datasets/vtasca/wikipedia-pageviews" class="platform-link" target="_blank" rel="noopener noreferrer">
                <img src="/static/hf-logo-bw.svg" alt="Hugging Face" style="width: 16px; height: 16px;">
                Hugging Face
            </a>
        </div>
        <div class="code-snippet-container">
            <pre><code class="language-bash"># Download the dataset
curl -o pageviews.csv https://raw.githubusercontent.com/vtasca/wikipedia-pageviews/main/data/pageviews.csv</code></pre>
        </div>
    </div>    
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
<script>    
    hljs.highlightAll();
    hljs.addPlugin(new CopyButtonPlugin());
    
    // Function to fetch dataset information from Hugging Face API
    async function fetchDatasetInfo(datasetName, rowsElementId, sizeElementId, fallbackRows, fallbackSize) {
        const API_URL = `https://datasets-server.huggingface.co/info?dataset=vtasca/${datasetName}`;
        
        try {
            const response = await fetch(API_URL);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            
            // Extract the information we need
            const numExamples = data.dataset_info.default.splits.train.num_examples;
            const numBytes = data.dataset_info.default.splits.train.num_bytes;
            const sizeInMB = (numBytes / (1024 * 1024)).toFixed(1);
            
            // Update the DOM elements
            const rowsElement = document.getElementById(rowsElementId);
            const sizeElement = document.getElementById(sizeElementId);
            
            if (rowsElement) {
                rowsElement.textContent = numExamples.toLocaleString();
            }
            
            if (sizeElement) {
                sizeElement.textContent = `${sizeInMB} MB`;
            }
            
        } catch (error) {
            console.error(`Error fetching ${datasetName} dataset info:`, error);
            
            // Fallback to default values on error
            const rowsElement = document.getElementById(rowsElementId);
            const sizeElement = document.getElementById(sizeElementId);
            
            if (rowsElement) {
                rowsElement.textContent = fallbackRows;
            }
            
            if (sizeElement) {
                sizeElement.textContent = fallbackSize;
            }
        }
    }
    
    // Function to fetch all dataset information
    async function fetchAllDatasetInfo() {
        // Fetch FOMC dataset info
        await fetchDatasetInfo(
            'fomc-statements-minutes',
            'fomc-rows',
            'fomc-data-size',
            '1,247',
            '2.3 MB'
        );
        
        // Fetch Wikipedia dataset info
        await fetchDatasetInfo(
            'wikipedia-pageviews',
            'wikipedia-rows',
            'wikipedia-data-size',
            '45,892',
            '15.7 MB'
        );
    }
    
    // Fetch all dataset info when the page loads
    document.addEventListener('DOMContentLoaded', fetchAllDatasetInfo);
</script>
{% endblock %}